--
-- V_MONTH  (View) 
--
CREATE OR REPLACE FORCE VIEW MASTER.V_MONTH
(NOM_ZD, DATE_PLAN, INPUT_DATE, PLAT_ID, PLAT_NAME, 
 DOG_ID, DOG_NUMBER, DOG_DATE, GROTP_ID, GROTP_NAME, 
 TEX_PD_ID, TEX_PD_NAME, LOAD_TYPE_ID, LOAD_TYPE_NAME, POLUCH_ID, 
 POLUCH_NAME, STAN_KOD, STAN_NAME, PROD_ID_NPR, NPR_SOBSTV_ID, 
 PLANSTRU_ID, PLANSTRU_NAME, NAZN_OTG_ID, NAZN_OTG_NAME, PAYFORM_ID, 
 PAYFORM_NAME, ZAYAV_VES, ZAYAV_SUM, CENA_OTP, ZAKAZ_ID)
AS 
SELECT
  MONTH.NOM_ZD,
  MONTH.DATE_PLAN,
  MONTH.INPUT_DATE,
  KLS_DOG.PREDPR_ID AS plat_id,
  plat.PREDPR_NAME AS plat_name,
  MONTH.DOG_ID,
  KLS_DOG.DOG_NUMBER,
  KLS_DOG.DOG_DATE,
  MONTH.GROTP_ID,
  grotp.PREDPR_NAME,
  MONTH.TEX_PD_ID,
  KLS_TEX_PD.TEX_PD_NAME,
  KLS_VID_OTGR.LOAD_TYPE_ID,
  KLS_LOAD_TYPE.TYPE_OTGR_NAME,
  MONTH.POLUCH_ID,
  poluch.PREDPR_NAME AS poluch_name,
  KLS_STAN.STAN_KOD,
  KLS_STAN.STAN_NAME,
  MONTH.PROD_ID_NPR,
  MONTH.npr_sobstv_id,
  MONTH.PLANSTRU_ID,
  KLS_PLANSTRU.NAME,
  MONTH.NAZN_OTG_ID,
  KLS_NAZN_OTG.NAZN_OTG_NAME,
  USL_DOG.PAYFORM_ID,
  KLS_PAYFORM.PAYFORM_NAME,
  MONTH.TONN_DECLARED AS ZAYAV_VES,
  MONTH.SUM_ZD AS ZAYAV_SUM,
  MONTH.CENA_OTP,
  MONTH.ZAKAZ_ID
FROM MONTH, KLS_DOG, USL_DOG, KLS_PREDPR PLAT, KLS_PREDPR POLUCH, KLS_PREDPR grotp,
     KLS_TEX_PD, KLS_STAN, KLS_PLANSTRU, KLS_NAZN_OTG, KLS_PAYFORM, KLS_VID_OTGR, KLS_LOAD_TYPE
WHERE
  MONTH.DOG_ID=USL_DOG.DOG_ID (+)
  AND MONTH.USL_NUMBER=USL_DOG.USL_NUMBER (+)
  AND MONTH.DOG_ID=KLS_DOG.ID (+)
  AND plat.ID(+)=KLS_DOG.PREDPR_ID
  AND poluch.id(+)=MONTH.POLUCH_ID
  AND grotp.id(+) = MONTH.GROTP_ID
  AND MONTH.GROTP_ID=KLS_TEX_PD.GROTP_ID (+)
  AND MONTH.tex_pd_id=KLS_TEX_PD.ID (+)
  AND MONTH.STAN_ID=KLS_STAN.ID (+)
  AND MONTH.PLANSTRU_ID=KLS_PLANSTRU.ID(+)
  AND MONTH.NAZN_OTG_ID=KLS_NAZN_OTG.ID(+)
  AND USL_DOG.PAYFORM_ID=KLS_PAYFORM.ID (+)
  AND MONTH.LOAD_ABBR=KLS_VID_OTGR.LOAD_ABBR (+)
  AND KLS_VID_OTGR.LOAD_TYPE_ID=KLS_LOAD_TYPE.ID (+);


